
registerTemplate("sifhouse", "templateSifHouse1", "Default");

function templateSifHouse1_resources() {
  // Font Monument: http://moorstation.org/typoasis/designers/steffmann/samples/m/monument.htm
  return ['/fonts/AveriaSerifLibre-Bold.ttf', '/fonts/JustAnotherHand.ttf'];
}

function templateSifHouse1(charData, resLoaded, $translate, alertService, options) {

  var doc = new PDFDocument({size: 'A4'});
  var OPTS = {
    'BG_COLOR': "#005ea6",
    'STROKE_COLOR': "#99c8f0",
    'FONT_BIG_SIZE': 12,
    'FONT_HEAD_COLOR': "#ffffff",
    'FONT_NORMAL_SIZE': 10,
    'FONT_SCRIPT_SIZE': 12,
    'FONT_USER_COLOR': "#000000",
    'LINE_HEIGHT': 12,
    'HEIGHT': doc.page.height,
    'WIDTH': doc.page.width,
    'RECT_HEIGHT': 23,
    'BORDER': 25,
    'FONT_HEAD': "fontHead",
    'FONT_USER': "fontUser",
    'BG_CREST_PATH': "m 91,28.31 c 15.99235,8.886715 32.12848,17.30352 50.90902,17.078355 22.88649,3.442668 46.09643,6.866217 68.69823,-0.271312 C 244.22794,39.953693 276.87518,30.947916 309,19.88 c 33.32306,-0.723622 67.06842,-9.012195 99.85034,-0.04177 44.66516,7.568104 87.67712,22.638169 132.61102,29.096342 20.15479,2.836587 39.49134,-8.48609 59.26294,-11.697627 C 616.93224,34.618261 631.33713,28.02443 644,17.59 c 13.64045,-8.967455 15.75099,14.740173 21.12112,23.309303 11.20214,29.748156 22.28146,59.530137 26.35622,91.241167 10.69653,54.66625 23.55035,109.38065 22.52266,165.45157 0.22103,27.75091 4.7263,55.57039 -1.27872,83.14691 -2.72453,26.3282 -5.86788,52.5588 -16.67151,77.0042 -13.17333,36.11037 -23.89946,73.40833 -38.57983,108.78737 -22.82034,34.22297 -43.51542,70.22398 -67.67431,103.32709 -38.74379,35.23708 -76.2919,72.45682 -115.77662,106.46529 -32.66212,11.64015 -66.03026,25.16814 -101.40045,21.6771 -23.65177,0.57378 -47.75224,1.44576 -69.34032,-9.94946 C 278.07883,777.69567 252.42806,767.12271 228.58563,754.39952 192.09434,713.56235 153.79099,674.07177 118.42686,632.39698 103.35568,606.43197 85.061397,581.92379 78.695337,552.02408 60.598788,493.56016 40.039415,435.59063 23.480104,376.81811 16.887591,324.61748 22.046681,272.09689 23.520271,219.84021 29.482735,180.93639 32.178684,141.01728 42.919215,103.17478 53.946143,74.783186 64.973072,46.391593 76,18 c 5,3.436667 10,6.873333 15,10.31 z M 351.76,128 c -10.57622,13.01937 7.08893,20.38096 6.51647,33.29708 4.06612,11.52073 -29.07881,-13.67035 -21.35951,2.64289 10.32274,7.92746 19.48357,16.60801 21.01895,30.231 5.05135,12.0962 8.99669,27.50593 -3.34097,36.64664 -10.6204,14.67545 -22.30661,28.19499 -38.60494,36.71239 2.01783,14.35212 1.68812,30.74319 -2.99397,43.77453 -17.35699,12.62516 -33.47748,26.4351 -45.7355,44.19383 -15.5573,8.7925 -10.36736,18.7507 0.66321,29.03706 6.85178,10.68881 20.61363,19.2206 16.07626,33.46458 12.29403,2.51403 25.49633,-21.31747 31.48271,-5.90238 7.22064,25.59242 14.64646,-9.72758 18.46183,10.62613 5.58625,10.77453 28.11233,6.83747 19.71433,-8.77602 -0.0222,-25.82997 12.70908,14.15212 21.09254,-4.68412 5.22133,-3.59371 -3.30393,25.22875 15.20859,22.21639 5.80823,-20.28876 13.14617,-11.56062 20.14302,-10.1125 4.48253,-17.47722 15.20773,-15.17127 27.93214,-6.52975 16.69029,12.10948 5.26516,-16.71495 13.42051,-24.46908 C 459.46462,380.797 467.84734,371.47549 476,362 c -16.37861,-12.08748 -27.70009,-30.08527 -47,-37.76 -10.06068,-8.56426 -18.20781,-17.93349 -15.14024,-32.02037 -1.70842,-12.06325 4.74851,-29.66886 -12.40361,-31.24945 -11.59414,-11.028 -22.013,-25.57374 -30.75401,-39.0308 -2.77739,-12.65468 -6.33435,-26.198 3.39704,-36.85017 -0.58884,-11.51867 26.78805,-20.74942 14.26078,-27.24966 -14.40603,7.0949 -21.51517,7.80384 -12.90553,-10.61789 13.8576,-11.48948 -5.46535,-21.06254 -5.48323,-34.35937 -2.29674,-23.489712 -8.26582,-6.7525 -13.87048,5.99294 -1.44691,3.04826 -2.89381,6.09651 -4.34072,9.14477 z M 512,121.78 c -19.57537,8.10977 -40.96273,13.27403 -55.09,30.24 -11.01819,0.2364 -30.44888,13.37898 -16.95123,12.80216 -14.77111,15.73699 7.86871,8.17001 3.86339,26.75511 -2.85223,-6.08474 10.24047,-24.53761 19.19705,-22.7427 C 469.34614,180.22305 475.67307,191.61152 482,203 c -14.29715,7.52131 -29.8336,13.04622 -42,24 9.23994,-1.25511 29.88575,-17.69346 31.39095,-3.63312 -1.00664,9.43267 -16.64116,21.66394 -26.58887,20.17604 C 432.73984,241.26363 419.36891,241.57691 412,230 c 1.12775,12.59177 2.88908,24.92401 12.6,34 -1.196,14.65296 -9.08943,30.532 2.67888,42.81161 6.25658,14.96456 21.30775,15.50964 20.33352,-2.95501 2.81402,-8.39367 6.75408,-27.63035 9.9015,-29.815 -5.07437,17.55075 -6.85863,37.31827 -1.52694,54.75523 C 460.31,340.97873 468.80061,351.47799 482,354 c -5.15695,-17.40425 -5.40826,-35.11818 -3,-53 8.30415,10.13688 15.6274,22.10398 30.06622,22.92095 20.87455,9.49377 12.59395,-2.91363 6.3123,-16.64594 -6.21211,-16.28389 -9.33051,-33.72091 -17.0261,-49.35389 C 497.91346,242.59695 492.98779,228.78683 484.2,216.28 c 0.10603,-12.62927 16.24597,-10.25128 13.19042,-27.25146 -8.82802,-22.81017 1.25044,0.52342 5.63958,9.97146 3.19196,14.73803 -24.33109,14.0652 -0.03,21.59 10.56978,-9.04966 21.65183,-17.77284 23.15617,-32.59996 C 530.73497,173.52377 537.59304,159.22824 532,144 c -10.3771,7.44996 -24.30033,9.12276 -31.41848,20.16563 -9.2772,11.11648 -21.91368,9.11895 -29.01152,-3.16563 10.11677,-15.65636 30.71531,-7.89218 44.89226,-14.1554 7.26988,-10.16525 19.18073,-21.42736 25.39774,-4.74593 -2.63849,21.54668 -6.78091,43.8427 -12.47646,64.55167 -7.05968,10.78442 -17.37033,19.93563 -24.7436,29.59819 C 499.64345,250.35459 510.68833,262.20361 515,275 c -3.03849,-20.61557 23.85287,14.6937 21.68356,3.01443 C 532.87898,261.72429 521.51903,246.06303 527,229 c 11.9685,5.02878 28.48489,17.00008 22.95,-4.69072 -1.96436,-18.6677 3.23724,-36.45858 7.95,-54.30928 -6.02309,-14.38731 -7.13553,-29.56993 -6.72,-45 -6.20861,-14.82389 -21.82968,8.71234 -22.88084,-14.53949 C 526.51022,96.879668 516.54273,119.44734 512,121.78 z M 198,129 c -11.03896,-11.51428 -19.9345,10.7365 -18.74067,20.24248 -2.02944,12.10753 -13.48585,23.17645 -6.37018,36.03678 2.64111,18.90955 12.69293,37.50671 8.11085,56.72074 11.4291,-6.11 25.93611,-17.99175 22.59026,3.60439 C 203.15404,258.25101 197.48992,270.50688 195,283 c 8.76492,-8.62186 21.88926,-21.97998 21.68292,-8.98445 2.6188,-12.48712 14.24126,-26.99596 6.038,-38.80937 -17.10312,-10.58555 -25.87607,-30.24822 -32.18964,-48.36482 -1.58333,-16.41935 -8.0723,-33.36878 1.28446,-48.60602 6.67263,-6.48777 16.73103,18.21252 29.64352,12.76012 10.73921,2.69437 27.21537,-1.34085 34.7029,4.09694 0.53911,12.95803 -15.97062,19.83461 -22.73902,30.18599 -7.63394,10.46245 -0.82602,25.36517 10.14686,30.71161 -12.48366,16.0814 -10.1457,37.90609 -17.22139,56.46956 C 219.98732,291.94082 217.62699,313.24846 205,330 c 12.29497,-6.23846 29.27491,-2.56487 35.98462,-16.7868 11.37678,-20.31935 11.3985,-3.62035 12.12671,10.77546 7.31854,8.04211 -9.68019,34.54234 1.07355,26.43966 14.52233,-4.6101 14.01208,-18.60797 15.65962,-31.25833 C 271.62936,302.78671 277.18428,286.43792 273,270 c 4.66667,16.33333 9.33333,32.66667 14,49 6.37406,-11.14479 17.685,-21.35153 21.19183,-33.04111 -5.32476,-13.06775 -6.80202,-24.40545 3.92839,-35.2634 11.5461,-13.05932 4.16149,-27.63328 -6.46029,-8.31459 -11.73017,3.78193 -23.78532,8.49585 -34.09144,-1.15129 -14.70839,1.34187 -18.76472,-25.77011 -5.72783,-20.92874 21.33577,11.43389 8.30424,-1.42872 -2.72429,-9.66627 -12.73998,-2.17291 -23.84785,-15.63264 -12.89228,-26.30333 8.20817,-11.42911 16.93834,-20.82788 30.64815,-10.85808 C 306.88114,187.37467 274.97635,160.80811 293.3947,164 289.00514,160.04312 269.58876,156.07099 263,146.38 241.85351,135.6702 222.32532,122.14063 202,110 c -1.33333,6.33333 -2.66667,12.66667 -4,19 z m -3.91,35 c 7.38171,16.84971 11.54819,36.80231 20.93888,51.71324 6.75882,9.47973 32.8097,4.24854 15.97112,-0.36324 -11.85196,-11.19369 -1.54518,-23.39949 3.33221,-35.35729 5.28634,-9.97307 -12.22299,-20.44383 -21.40399,-23.01315 C 197.37441,151.77465 196.60884,139.94258 194.09,164 z M 494,156 c -10.73385,21.39842 7.18897,-0.0239 0,0 z m -9,9 c 0,-5.06212 0,-7.36765 0,0 z m -246,-3 c -6.66244,10.78978 9.98905,11.33648 0,0 z m 251,4 c 1.04044,3.31658 1.84518,-1.37377 0,0 z m -206,26 c 1.05549,-10.55489 1.23978,-12.39777 0,0 z m 162,1.03 c -12.02767,8.6545 -24.51436,3.56561 -36.98711,-1.10587 -17.00065,-2.54815 9.17695,13.31216 15.98711,15.03587 17,-5.32 34,-10.64 51,-15.96 -1.41512,-8.6444 -21.76966,2.7432 -30,2.03 z m -147,7.79 c -15.33333,-3.94 -30.66667,-7.88 -46,-11.82 6.12417,10.13589 24.09658,9.12323 35.02214,14.74128 11.70933,7.43001 26.01739,2.2495 34.05605,-6.84374 C 328.34056,185.38125 302.36158,201.68605 299,200.82 z m 146.44,8.23 c 8.65503,3.16728 2.35017,-6.97237 0,0 z M 579.54,234 c -12.67068,24.15012 -29.56101,49.89647 -22.55977,78.30675 4.58833,27.5494 11.997,55.1262 14.48248,82.72198 -5.48289,10.26289 -1.14332,29.86016 -15.66767,31.53087 -17.70537,11.32038 -17.07866,-3.17089 -17.92786,-17.87751 C 534.01229,384.70122 526.72645,361.13878 515.86,339.21 507.48231,336.94637 488.22959,320.84934 486.28441,329.1877 485.45351,344.18031 490.42513,357.78228 497,371 c -8.92634,-5.71661 -27.76037,5.62282 -24.66841,14.99894 13.97774,6.47838 15.52785,22.49804 21.65841,35.00106 -1.06017,13.2344 -12.95906,28.78309 -1.99,40 4.76045,-16.13529 6.31479,16.02227 1.73095,22.06457 -4.24068,17.29393 -11.94728,34.6765 -14.03502,51.91536 4.43469,12.61669 8.86938,25.23338 13.30407,37.85007 10.02695,6.70443 30.05784,-11.62841 29.51912,5.4261 6.89162,15.82574 -10.70123,26.3187 -17.09928,39.24992 -6.82734,8.84768 -26.25355,10.81366 -33.01575,0.0243 -8.68694,-10.87235 -27.70399,-5.59266 -18.57631,10.04625 5.92639,2.49466 31.5735,-0.27219 17.17222,13.42343 -12.90921,8.86764 -12.75296,22.26422 3.37404,20.35367 6.79066,-5.2972 21.80809,-32.65759 18.49596,-10.8603 -5.93071,14.2068 23.16452,14.96529 20.51858,0.37428 1.79214,-22.45005 10.8948,-8.27049 19.39034,2.86706 7.41685,-5.48789 -3.79893,-33.93341 7.39762,-25.15095 13.33222,14.10266 6.87346,-14.91106 4.5394,-22.59001 1.86411,-15.49158 27.63914,8.76217 17.70376,-14.48624 1.56422,-12.85797 -18.00329,-23.43516 -4.83332,-34.26789 10.54948,-10.26171 -4.67228,-22.89213 -6.65794,-34.30599 -9.18809,-12.4438 16.95464,-17.37235 10.75115,-31.32295 6.47127,-19.73425 -20.1161,-1.38805 -21.45827,-17.83134 -4.41978,-14.04291 -6.82526,-26.75288 12.19859,-25.28225 10.31932,-9.44791 29.61937,5.67104 30.41405,-4.73763 -1.6125,-12.51172 -1.48444,-24.78254 2.6578,-37.34844 0.36032,-25.58177 -11.65589,-51.77347 -1.59402,-76.81826 0.32017,-7.06784 12.65737,-38.6896 1.85813,-23.0376 -12.10409,18.95095 -11.03144,9.29557 -6.82189,-7.16989 0.21401,-6.27711 9.39099,-37.01842 1.36288,-25.29345 -7.221,15.07797 -18.2584,19.74817 -10.7939,0.10543 7.79183,-19.65351 20.30359,-39.02122 14.84281,-61.04296 C 584.15305,199.26116 580.75996,230.42966 579.54,234 z M 278,210 c -4.22228,10.56192 8.46382,-0.43231 0,0 z m -133.37,29 c 6.32626,17.95422 20.76868,34.13561 18.35,54 -8.35379,-9.84307 -21.06303,-27.9864 -12.10113,-4.83061 1.00656,7.17663 11.71163,37.06179 2.79813,27.25332 -12.81896,-17.4967 -13.93383,-10.48381 -9.86926,7.37536 3.60385,13.98009 12.2075,26.92359 7.0928,41.90304 -4.39705,23.8779 -1.67886,47.81219 1.86946,71.49624 -5.70476,21.6036 12.2634,3.15471 23.22876,12.29225 6.88116,7.26612 30.86283,9.72486 21.80233,22.07484 -2.78766,13.30186 -26.75808,11.21115 -24.98687,20.09025 4.57837,11.14033 20.80567,24.11442 3.9242,31.87659 -2.96613,9.9703 -7.44167,26.44599 1.43571,35.02388 13.35717,9.81719 -7.56628,20.72551 -4.32355,33.87874 -11.74408,22.90498 21.3263,-1.44821 17.43453,13.8214 0.96821,9.10274 -10.1508,37.63023 5.54169,23.07033 13.41838,-9.41784 -3.63711,25.89998 8.37055,24.67437 11.37891,-10.22167 19.50209,-15.60069 19.53106,4.43484 9.72453,13.04333 18.59667,-1.91698 17.36368,-13.93052 3.77685,-11.89236 13.0408,24.01141 21.27661,15.95837 18.46186,-6.53457 4.35269,-17.39462 -4.75661,-25.8506 -8.95844,-11.17912 25.4232,0.12628 21.38077,-15.75131 0.65332,-16.59426 -16.83207,-0.62593 -24.78509,3.18779 -11.98142,4.23269 -22.4922,-11.23475 -33.85267,-15.32011 -13.04971,-3.58354 -13.62394,-21.52922 -7.2813,-31.09048 5.44976,-8.25238 24.34907,6.31286 29.4799,-7.90301 16.64085,-13.79021 13.59761,-38.03822 5.35589,-55.5928 C 243.52879,492.02568 232.04625,471.93178 239,452 c 11.04615,16.39613 5.69071,-12.48895 2.28831,-19.19384 0.82582,-12.9419 -6.28963,-28.88659 7.5724,-36.89918 11.72918,-7.23646 13.79761,-23.18743 -2.92219,-24.14865 -19.92697,0.61015 -8.56598,-16.19787 -6.16906,-28.01555 7.68867,-17.25228 4.37417,-21.7224 -12.00473,-11.01591 -14.13578,4.31276 -14.99573,22.62185 -23.06006,33.33557 C 199.5936,388.58006 195.92884,411.85051 194,435 179.1831,441.11882 178.99803,418.52886 171.50957,410.26872 165.55073,398.47748 156.35183,387.15163 162.79933,373.57845 166.37241,350.90922 172.7926,328.55626 176,306 c -8.45179,-31.37702 -18.37849,-62.29632 -29,-93 -0.79,8.66667 -1.58,17.33333 -2.37,26 z M 280,226 c 1.04044,3.31658 1.84518,-1.37377 0,0 z m 66.7,70.04 c 12.98,0.32 25.96,0.64 38.94,0.96 2.94846,10.35036 -3.93876,31.46552 13.36,26.11 13.11803,3.48229 24.72511,14.4325 13.83511,27.43164 -1.61735,13.10923 -14.3246,23.35591 -26.14342,14.55284 -17.22275,-15.93815 -10.72642,1.31645 -7.25277,14.34108 9.72614,17.113 -14.82765,10.01419 -24.57686,13.37181 C 352.17526,384.58325 359.00831,367.60626 360,356 c -9.08729,12.11854 -22.50649,10.93284 -36.05565,9.348 -7.30668,-9.33241 -14.79341,-23.00778 -6.13435,-34.718 11.38163,-4.86309 31.12224,-2.77701 27.4448,-20.15937 0.48173,-4.81021 0.96347,-9.62042 1.4452,-14.43063 z M 525,328 c 1.04044,3.31658 1.84518,-1.37377 0,0 z m -61,104.92 c -15.91815,2.30769 -32.32077,0.2715 -45.95797,10.39783 -13.64659,3.77511 -23.2645,14.85735 -25.09739,28.87861 -6.11846,19.19442 19.17027,31.7684 17.01049,51.24964 5.30198,16.11047 -19.33305,6.60548 -28.51317,10.3244 -11.25058,-2.98457 -16.90169,-25.75966 -24.32829,-3.2702 -8.34839,6.20317 -24.34536,16.34799 -29.76936,1.58435 -14.1227,-11.05982 -0.94414,-21.93352 6.19718,-32.84838 4.58005,-12.04303 9.86893,-25.07222 2.1078,-37.05327 C 334.33702,446.26281 316.21717,446.26623 305,439.73 c -18.67343,-2.5281 -37.35749,-4.97985 -56,-7.73 2.21838,12.41596 7.4114,24.96229 1,37 10.51333,4.91694 30.05719,0.74646 29.43068,16.87342 C 287.42651,499.77444 280.49825,508.7975 268,516 c 2.69677,14.02925 27.42823,6.01208 28.89968,18.19615 -0.45267,7.79344 -2.95903,38.3987 7.67533,20.76537 9.62921,-20.67305 7.68209,-4.93057 15.27252,7.14277 5.81729,12.91617 10.79836,-21.92235 18.12275,4.23637 8.35202,14.41459 22.62399,-1.78959 11.95266,-13.58946 0.45249,-22.56836 9.81301,5.17432 19.24656,3.81609 11.60022,-11.59903 17.1386,-14.79284 11.68238,4.48656 -6.55142,14.3607 19.55063,14.81403 19.97744,-0.47913 6.49594,-17.22381 14.62285,24.60427 16.44428,-3.7338 1.78688,-23.43987 9.95282,-3.39464 16.7264,7.15908 6.81741,-6.68443 -5.0585,-27.67175 4.72985,-33.92508 6.25239,-6.37923 36.20473,-10.95923 20.47718,-19.00711 -13.86145,-4.86439 -6.13741,-24.78411 -2.82157,-33.39785 9.09975,-5.62617 33.53634,-3.06895 23.75921,-18.76738 -9.34104,-8.93018 15.46216,-31.89711 -3.5045,-27.13825 -4.21339,0.38522 -8.42678,0.77045 -12.64017,1.15567 z M 299,624 c -4.46789,-5.36147 -8.47672,-10.17206 0,0 z m 137,2 c 5.54508,-5.54508 6.91698,-6.91698 0,0 z m -162,38 c 3.56257,7.63409 14.53174,31.13945 0,0 z m 183,1 c -3.99016,14.96311 -4.50051,16.87691 -0.21475,0.80531 L 457,665 z m -222,15 c 2.27117,-10.22027 2.49516,-11.2282 0,0 z m 266.15,-7.98 c 5.05301,7.99147 7.74698,-4.89173 0,0 z",
    'BG_CREST_COLOR': '#e6f3fc',
    'CONTENT_WIDTH':0,
    'MIDDLE_X':0,
    'RIGHT_X':0
  };
  OPTS['CONTENT_WIDTH'] = OPTS.WIDTH - 2 * OPTS.BORDER;
  OPTS['MIDDLE_X'] = OPTS.WIDTH / 2;
  OPTS['RIGHT_X'] = OPTS.WIDTH - OPTS.BORDER;

  doc.registerFont(OPTS.FONT_HEAD, resLoaded["/fonts/AveriaSerifLibre-Bold.ttf"], OPTS.FONT_HEAD);
  doc.registerFont(OPTS.FONT_USER, resLoaded["/fonts/JustAnotherHand.ttf"], OPTS.FONT_USER);


  var y = OPTS.BORDER + 3;
  // headline with housename + campaign
  templateSifHouse1_line(doc, OPTS.BORDER, y, 130, OPTS.MIDDLE_X - 7 - OPTS.BORDER,
    $translate.instant('SIFHOUSE.HOUSENAME'), charData.housename,
    OPTS, {"bigHead":"yes"});

  templateSifHouse1_line(doc, OPTS.MIDDLE_X + 3, y, 130, OPTS.MIDDLE_X - 7 - OPTS.BORDER,
    $translate.instant('SIFHOUSE.CAMPAIGN'), charData.campaign,
    OPTS, {"bigHead":"yes"});
  y += OPTS.RECT_HEIGHT + 3;

  // realm
  templateSifHouse1_line(doc, OPTS.BORDER, y, 85, 400,
    $translate.instant('SIFHOUSE.REALM'), charData.realm,
    OPTS);
  y += OPTS.RECT_HEIGHT + 2;
  // liege
  templateSifHouse1_line(doc, OPTS.BORDER, y, 85, 400,
    $translate.instant('SIFHOUSE.LIEGE'), charData.liege,
    OPTS);
  y += OPTS.RECT_HEIGHT + 2;

  // =============== statistics headline =======================
  y += 2;
  templateSifHouse1_line(doc, OPTS.BORDER, y, 400, 400,
    $translate.instant('SIFHOUSE.STATISTICS'), "",
    OPTS);
  y += OPTS.RECT_HEIGHT + 4;

  for (var i=0; i<charData.stats.length; i++) {
    var stat = charData.stats[i];
    templateSifHouse1_line(doc, OPTS.BORDER, y, 85, 400,
      stat.name, stat.text,
      OPTS, {"printCrestBlock": stat.val});
    y += OPTS.RECT_HEIGHT + 2;
  }

  // crest
  doc.save(); // store graphic context
  // clipping path
  var scaleX=0.67;
  var translateX = OPTS.RIGHT_X - 180 * scaleX - 10;
  var translateY = OPTS.BORDER + OPTS.RECT_HEIGHT + 10;

  doc.path(charData.crest.shape.path).translate(translateX,translateY).scale(scaleX,scaleX).clip();

  for (var i=0; i<charData.crest.elements.length; i++) {
    var el = charData.crest.elements[i];
    switch (el.svgType) {
      case "path":
        console.log("path="+el.path+" fill="+el.fill);
        doc.path(el.path).fill(el.fill);
        break;
      case "circle":
        console.log("circle x="+el.x+" y="+el.y+" r="+el.r+" fill="+el.fill);
        doc.circle(parseInt(el.x), parseInt(el.y), parseInt(el.r)).fill(el.fill);
        break;
      case "rect":
        console.log("rect x="+el.x+" y="+el.y+" w="+el.w+" h="+el.h+" fill="+el.fill);
        doc.rect(el.x, el.y, el.w, el.h).fill(el.fill);
        break;
    }
  }

  // restore graphic context to reset clipping path
  doc.restore();
  doc.save();
  // border without clipping path
  doc.translate(translateX,translateY).path(charData.crest.shape.path)
    .lineWidth(3)
    .scale(scaleX,scaleX)
    .stroke(charData.crest.shape.strokecolor);

  doc.restore();
  doc.translate(0,0); // reset translate

  // 8 boxes
  var boxes = charData.textblocks;
  y += 2;
  var w = OPTS.MIDDLE_X - OPTS.BORDER - 3;
  var h = (OPTS.HEIGHT - y - 1.5 * OPTS.BORDER) / 4;
  for (var i=0; i<4;i++) {
    templateSifHouse1_textbox(doc, OPTS.BORDER, y, w, h,
      boxes[i*2].name, boxes[i*2].text, OPTS);

    templateSifHouse1_textbox(doc, OPTS.MIDDLE_X + 3, y, w, h,
      boxes[i*2+1].name, boxes[i*2+1].text, OPTS);

    y += h + 3;
  }
  return doc;
}


function templateSifHouse1_line(doc, x, y, w1, w2, title, content, opts, custom) {
  var dX = 0;
  if (angular.isDefined(custom) && angular.isDefined(custom.printCrestBlock)) {
    doc.save();
    doc.path(opts.BG_CREST_PATH)
      .translate(x + 4, y + 2).scale(0.023, 0.023)
      .fill(opts.BG_CREST_COLOR);
    doc.restore();
    doc.fontSize(opts.FONT_NORMAL_SIZE).font(opts.FONT_USER).fillColor(opts.FONT_USER_COLOR)
      .text(custom.printCrestBlock, x, y + 8, {"width":25,"align":"center"});
    dX = 25;
  }
  doc.rect(x + dX, y, w1, opts.RECT_HEIGHT).fill(opts.BG_COLOR);
  doc.rect(x, y, w2, opts.RECT_HEIGHT).stroke(opts.STROKE_COLOR);
  doc.fillColor(opts.FONT_HEAD_COLOR).font(opts.FONT_HEAD);
  var deltaY;
  if (angular.isDefined(custom) && angular.isDefined(custom.bigHead)) {
    doc.fontSize(opts.FONT_BIG_SIZE);
    deltaY = 4;
  } else {
    doc.fontSize(opts.FONT_NORMAL_SIZE);
    deltaY = 6;
  }
  doc.text(title.toUpperCase(), x + dX, y + deltaY, {'width': w1, 'align':'center'});
  if (angular.isDefined(content) && content.length > 0) {
    doc.fontSize(opts.FONT_SCRIPT_SIZE).fillColor(opts.FONT_USER_COLOR).font(opts.FONT_USER)
      .text(content, x + w1 + 3 + dX, y + 7, {'width':w2,'height':opts.RECT_HEIGHT});
  }
}


function templateSifHouse1_textbox(doc, x, y, w, h, title, content, opts) {
  doc.rect(x, y, w, opts.RECT_HEIGHT).fill(opts.BG_COLOR);
  doc.rect(x, y, w, h).stroke(opts.STROKE_COLOR);
  doc.fillColor(opts.FONT_HEAD_COLOR).font(opts.FONT_HEAD);
  doc.fontSize(opts.FONT_NORMAL_SIZE).text(title.toUpperCase(), x, y + 6, {'width': w, 'align':'center'});
  if (angular.isDefined(content) && content.length > 0) {
    doc.fontSize(opts.FONT_SCRIPT_SIZE).fillColor(opts.FONT_USER_COLOR).font(opts.FONT_USER)
      .text(content, x + 3, y + opts.RECT_HEIGHT + 3, {'width': w});
  }
}
